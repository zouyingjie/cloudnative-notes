<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.0">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>容器基础技术：cgroups | 云原生架构笔记</title><meta name="description" content="构建大规模高可用的分布式系统">
    <link rel="preload" href="/cloudnativenotes/assets/style-C8UjLoOj.css" as="style"><link rel="stylesheet" href="/cloudnativenotes/assets/style-C8UjLoOj.css">
    <link rel="modulepreload" href="/cloudnativenotes/assets/app-C-eiXR-Q.js"><link rel="modulepreload" href="/cloudnativenotes/assets/docker-cgroups.html-yRJlFdgp.js"><link rel="modulepreload" href="/cloudnativenotes/assets/docker-cgroups.html-oZZix2EO.js">
    <link rel="prefetch" href="/cloudnativenotes/assets/index.html-CaDEAGlr.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/summary.html-5z9O3CRM.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/cron.html-BJpwXMoc.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/distributed-cache.html-BKPXsc_g.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/distributed-lock.html-Bkc2bnt8.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/session.html-DcEZyuC3.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/tracing.html-yfpjvzw7.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/uniqueid.html-DUYGPfKT.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/cap.html-B_eIltcI.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/clock.html-KdfBpAtx.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/consistency-and-consensus.html-B_fCTLL3.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/overview.html-Bgzt7s1r.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/sharding-and-replication.html-DUvyRyQl.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/transaction.html-CtA4W0xM.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/about.html-Bj3jP03N.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/dots.html-BFeEvQ5S.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/learn.html-CcJfDuaJ.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/perspective.html-Cm4yK9nC.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/responsibility.html-Dim4SFw7.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/toc.html-DvyeioSm.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/01.service-discovery.html-DCArp20B.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/02.service-config.html-wuC-D5mv.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/06.service-health.html-BYhliNkX.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/07.service-resilience-01.html-Dj-QSlZB.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/07.service-resilience-02.html-DUX16yyQ.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/08.traffic-schedule.html-Dxbe7Y59.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-Bb_GtxkL.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-fbfqkZuh.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/architecture.html-DJlJ8uIA.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/computing.html-Dcz7xqt8.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/definition.html-DcY1Fd2x.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/pass.html-CpqYH6Ci.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-ahw7-hdr.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/docker-arch.html-BgXIXtLU.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/docker-devicemapper.html-CeexLsdc.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/docker-filesystem.html-CqqKrl0p.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/docker-namespace.html-DkDkZSP1.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/docker.html-BYi6I0z-.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-DZ8leFL_.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/cicd.html-BQwJRK1k.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/devops.html-Bkik9OU5.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/gitflow.html-BGbxGwE2.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-D-_Pw43X.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/application.html-DxKvtGl3.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/architecture.html-CgZOV9r7.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/cka.html-CPTlxrnN.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/config.html-velI3VEj.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/controller.html-k2T6cqne.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/future.html-BsLZsvYN.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/monitoring.html-DTZQN_t0.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/network.html-DBksTdnb.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/pod.html-DvVxe9V4.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/scheduler.html-CAcDBcea.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/security.html-DWM-cXsC.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/storage.html-DOJKqM46.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-WEBBo--q.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/definition.html-DC1x1JT3.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/logging.html-BmDmiZXu.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/metrics.html-BIerCiie.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/monitoring.html-Dyz9s1ab.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/trace.html-CVfGSZ9N.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/dependency.html-BKhmP467.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/discovery.html-BV343_90.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/lifecycle.html-CDWsGv0r.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/scale.html-H75RsCaz.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/stack.html-r7RjtVmp.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/communication.html-BXw213ih.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/design.html-CTn3BIoS.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/servicemesh.html-DtdX3YpQ.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/rest.html-C1iE-8Cc.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/webapi.html-CHk3nZs5.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-9l9raxog.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/history.html-CVrvIJBh.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-9l9raxog.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/mysql.html-C7Za4xWb.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/nosql.html-CZOZOwW8.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/REAEMD.html-CkzaJNpe.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/auth.html-DEvRT4s_.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/permission.html-DxiAcbsM.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/roadmap.html-CSbh4B2o.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/tls-cert.html-lCTnlmUr.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/contract.html-f9rU0CZJ.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/function.html-COBB1Ko5.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/load.html-DuAW42s-.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/spring-boot-unit-testing.html-CSz971jG.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/testcontainer.html-DJN5emyo.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/unit-test.html-BuuSHng_.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/availability.html-eZd_Y02n.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/decoupling.html-BoiDHrhp.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/fault-tolerance.html-BN40USBU.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/patterns.html-n88CnXZx.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/redundancy.html-CjCijiXC.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/loadbalancing.html-CWkvv6J6.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/mirroring.html-CpQrip5y.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/rate-limiting.html-4-4WIe2F.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/routing.html-D5F4XlL8.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/404.html-DqZtwkbf.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-DsMxHoe1.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/summary.html-Q6t1kFgr.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/cron.html-Dra8Tne5.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/distributed-cache.html-ty6fkx7S.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/distributed-lock.html-IGRU4884.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/session.html-B9otZ8y_.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/tracing.html-DqqQpAG7.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/uniqueid.html-BJ4CDN8L.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/cap.html-hpEFshBw.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/clock.html-Bw-k7agB.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/consistency-and-consensus.html-CMgxqBLl.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/overview.html-BDQ2tztl.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/sharding-and-replication.html-BPvJZka6.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/transaction.html-BRXvto4R.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/about.html-bDLcxvSU.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/dots.html-2bB6Ku5l.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/learn.html-D5_C_y2e.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/perspective.html-CuEkVcup.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/responsibility.html-D2uQ6HKY.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/toc.html-CCU8umSy.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/01.service-discovery.html-CJAFPF0c.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/02.service-config.html-C0dT9MoJ.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/06.service-health.html-x4gh2uOy.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/07.service-resilience-01.html-C6878baV.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/07.service-resilience-02.html-DC3AQT_a.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/08.traffic-schedule.html-DgSx9VI2.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-Br69DyaM.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-CRtCP2eX.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/architecture.html-ndQf8NmT.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/computing.html-DAdfg3A6.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/definition.html-1slUJu0S.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/pass.html-BI14EvKo.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-ocX59_KX.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/docker-arch.html-sAcu90h4.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/docker-devicemapper.html-DyyGUOsZ.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/docker-filesystem.html-B-AjM8BT.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/docker-namespace.html-CkkVUzCp.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/docker.html-BLzfnp1G.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-Bcpe9sBH.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/cicd.html-DnIxr7nV.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/devops.html-rSNNi7J-.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/gitflow.html-CeOrhknP.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-CtiE0YWL.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/application.html-BFOT_eF4.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/architecture.html-Dc4NXGaN.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/cka.html-CgPyOSG3.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/config.html-CqHsKfL2.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/controller.html-DjkUXQkH.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/future.html-D34sD3Y8.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/monitoring.html-CToHqHbr.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/network.html-BJLLLwuE.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/pod.html-wpRnt80g.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/scheduler.html-ChB2Dnju.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/security.html-B1mAlvG1.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/storage.html-DfrhP5dU.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-DuVr14wn.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/definition.html-CYhZ0K2_.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/logging.html-DZ1T0vlO.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/metrics.html-NpQXjRPE.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/monitoring.html-BbJFPRdf.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/trace.html-B6jHcs82.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/dependency.html-CLPqcmBN.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/discovery.html-DLnVIG59.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/lifecycle.html-DbMEvmWs.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/scale.html-CD8rqfDC.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/stack.html-y5jQssus.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/communication.html-AUvi7IaZ.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/design.html-CmHJURnv.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/servicemesh.html-SLNvveq9.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/rest.html-BuuGuwVc.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/webapi.html-BFHol3Z1.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-BLuU14Un.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/history.html-Bo5Jk6Z9.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/index.html-BLuU14Un.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/mysql.html-DY6VZY0J.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/nosql.html-BnPzgDlf.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/REAEMD.html-B9hyN1MS.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/auth.html-C1IynFQA.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/permission.html-6DRnqYOD.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/roadmap.html-Cj29XfbQ.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/tls-cert.html-DQRQ2S_V.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/contract.html-DLjt-c0Q.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/function.html-COQyIpZW.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/load.html-4Xd7pdLN.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/spring-boot-unit-testing.html-DNhjdjQR.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/testcontainer.html-CdxrgXLE.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/unit-test.html-BnApfdzU.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/availability.html-B6i0aGsC.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/decoupling.html-T03ienA-.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/fault-tolerance.html-CoDoYsNs.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/patterns.html-XA-MeAJP.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/redundancy.html-Cw-rGKyJ.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/loadbalancing.html-CMPnvy1k.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/mirroring.html-B4Yk6fXQ.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/rate-limiting.html-XirS-n2q.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/routing.html-BqsuJym0.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/404.html-BpKyP9F4.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/giscus-DrGxERkK.js" as="script"><link rel="prefetch" href="/cloudnativenotes/assets/buttons.esm-DK2fWHEW.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container" data-v-efed79f6><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/cloudnativenotes/" class=""><img class="logo" src="/cloudnativenotes/images/microservices-logo.svg" alt="云原生架构笔记"><span class="site-name can-hide">云原生架构笔记</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/cloudnativenotes/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zouyingjie/cloudnativenotes/discussions" rel="noopener noreferrer" target="_blank" aria-label="讨论"><!--[--><!--]--> 讨论 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zouyingjie/cloudnativenotes" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/cloudnativenotes/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zouyingjie/cloudnativenotes/discussions" rel="noopener noreferrer" target="_blank" aria-label="讨论"><!--[--><!--]--> 讨论 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zouyingjie/cloudnativenotes" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/cloudnativenotes/end/about.md" class="sidebar-item sidebar-heading" aria-label="前言"><!--[--><!--]--> 前言 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/end/toc.md" class="sidebar-item sidebar-heading" aria-label="目录"><!--[--><!--]--> 目录 <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading">通用设计 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item">数据建模 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/common-design/modeling/history.html" class="sidebar-item" aria-label="DBMS的演进"><!--[--><!--]--> DBMS的演进 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/common-design/modeling/" class="sidebar-item" aria-label="数据库索引设计与优化"><!--[--><!--]--> 数据库索引设计与优化 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/common-design/modeling/mysql.html" class="sidebar-item" aria-label="MySQL 开发规范"><!--[--><!--]--> MySQL 开发规范 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/common-design/modeling/nosql.html" class="sidebar-item" aria-label="NoSQL 建模规范"><!--[--><!--]--> NoSQL 建模规范 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item">API 设计 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/common-design/api/rest.html" class="sidebar-item" aria-label="WEB API 设计规范"><!--[--><!--]--> WEB API 设计规范 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/common-design/api/webapi.html" class="sidebar-item" aria-label="Web API 路径设计哪家强"><!--[--><!--]--> Web API 路径设计哪家强 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item">认证与授权 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/common-design/security/roadmap.html" class="sidebar-item" aria-label="方案概览"><!--[--><!--]--> 方案概览 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/common-design/security/auth.html" class="sidebar-item" aria-label="身份认证"><!--[--><!--]--> 身份认证 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/common-design/security/permission.html" class="sidebar-item" aria-label="授权管理"><!--[--><!--]--> 授权管理 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">分布式系统-理论篇 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/distributed-system-theory/overview.html" class="sidebar-item" aria-label="分布式系统概览"><!--[--><!--]--> 分布式系统概览 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/distributed-system-theory/sharding-and-replication.html" class="sidebar-item" aria-label="数据分区与复制"><!--[--><!--]--> 数据分区与复制 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/distributed-system-theory/consistency-and-consensus.html" class="sidebar-item" aria-label="分布式共识"><!--[--><!--]--> 分布式共识 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/distributed-system-theory/transaction.html" class="sidebar-item" aria-label="分布式事务"><!--[--><!--]--> 分布式事务 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/distributed-system-theory/clock.html" class="sidebar-item" aria-label="分布式时钟"><!--[--><!--]--> 分布式时钟 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">分布式系统-工程篇 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/distributed-system-engineering/distributed-lock.html" class="sidebar-item" aria-label="分布式锁的设计"><!--[--><!--]--> 分布式锁的设计 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/distributed-system-engineering/uniqueid.html" class="sidebar-item" aria-label="分布式唯一 ID"><!--[--><!--]--> 分布式唯一 ID <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/distributed-system-engineering/cron.html" class="sidebar-item" aria-label="分布式任务调度"><!--[--><!--]--> 分布式任务调度 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/distributed-system-engineering/session.html" class="sidebar-item" aria-label="分布式会话"><!--[--><!--]--> 分布式会话 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/distributed-system-engineering/tracing.html" class="sidebar-item" aria-label="分布式追踪"><!--[--><!--]--> 分布式追踪 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/cloudnativenotes/cloudnative/summary.md" class="sidebar-item sidebar-heading active" aria-label="云原生架构"><!--[--><!--]--> 云原生架构 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item">什么是云原生 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/cloudnative/architecture/architecture.html" class="sidebar-item" aria-label="分布式系统的演进"><!--[--><!--]--> 分布式系统的演进 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/architecture/definition.html" class="sidebar-item" aria-label="云原生的定义"><!--[--><!--]--> 云原生的定义 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/architecture/pass.html" class="sidebar-item" aria-label="云原生平台的构建"><!--[--><!--]--> 云原生平台的构建 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item active">不可变基础设施 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item active">容器 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/cloudnative/container/docker-namespace.html" class="sidebar-item" aria-label="容器基础技术：namespace"><!--[--><!--]--> 容器基础技术：namespace <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloudnativenotes/cloudnative/container/docker-cgroups.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="容器基础技术：cgroups"><!--[--><!--]--> 容器基础技术：cgroups <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/cloudnativenotes/cloudnative/container/docker-cgroups.html#案例-cgroup-限制内存" class="router-link-active router-link-exact-active sidebar-item" aria-label="案例：cgroup 限制内存"><!--[--><!--]--> 案例：cgroup 限制内存 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloudnativenotes/cloudnative/container/docker-cgroups.html#cgroup-术语" class="router-link-active router-link-exact-active sidebar-item" aria-label="cGroup 术语"><!--[--><!--]--> cGroup 术语 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/cloudnativenotes/cloudnative/container/docker-cgroups.html#控制器-controller" class="router-link-active router-link-exact-active sidebar-item" aria-label="控制器（controller）"><!--[--><!--]--> 控制器（controller） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloudnativenotes/cloudnative/container/docker-cgroups.html#控制组-control-group" class="router-link-active router-link-exact-active sidebar-item" aria-label="控制组（control group）"><!--[--><!--]--> 控制组（control group） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloudnativenotes/cloudnative/container/docker-cgroups.html#层级结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="层级结构"><!--[--><!--]--> 层级结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloudnativenotes/cloudnative/container/docker-cgroups.html#任务-task" class="router-link-active router-link-exact-active sidebar-item" aria-label="任务（task）"><!--[--><!--]--> 任务（task） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloudnativenotes/cloudnative/container/docker-cgroups.html#文件系统" class="router-link-active router-link-exact-active sidebar-item" aria-label="文件系统"><!--[--><!--]--> 文件系统 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="/cloudnativenotes/cloudnative/container/docker-filesystem.html" class="sidebar-item" aria-label="容器基础技术：文件系统"><!--[--><!--]--> 容器基础技术：文件系统 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/container/docker-devicemapper.html" class="sidebar-item" aria-label="容器基础技术：devicemapper"><!--[--><!--]--> 容器基础技术：devicemapper <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/container/docker.html" class="sidebar-item" aria-label="Docker 最佳实践"><!--[--><!--]--> Docker 最佳实践 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item">Kubernetes <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/cloudnative/kubernetes/architecture.html" class="sidebar-item" aria-label="整体架构"><!--[--><!--]--> 整体架构 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/kubernetes/pod.html" class="sidebar-item" aria-label="Pod 那些事"><!--[--><!--]--> Pod 那些事 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/kubernetes/controller.html" class="sidebar-item" aria-label="控制器对象"><!--[--><!--]--> 控制器对象 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/kubernetes/config.html" class="sidebar-item" aria-label="配置管理对象"><!--[--><!--]--> 配置管理对象 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/kubernetes/network.html" class="sidebar-item" aria-label="网络原理"><!--[--><!--]--> 网络原理 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/kubernetes/storage.html" class="sidebar-item" aria-label="存储原理"><!--[--><!--]--> 存储原理 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/kubernetes/scheduler.html" class="sidebar-item" aria-label="调度原理"><!--[--><!--]--> 调度原理 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/kubernetes/security.html" class="sidebar-item" aria-label="安全机制"><!--[--><!--]--> 安全机制 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/kubernetes/application.html" class="sidebar-item" aria-label="应用封装与扩展"><!--[--><!--]--> 应用封装与扩展 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/kubernetes/monitoring.html" class="sidebar-item" aria-label="集群监控与 debug"><!--[--><!--]--> 集群监控与 debug <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item">服务网格 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/cloudnative/servicemesh/communication.html" class="sidebar-item" aria-label="服务通信的演进"><!--[--><!--]--> 服务通信的演进 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/servicemesh/servicemesh.html" class="sidebar-item" aria-label="服务网格产品与生态"><!--[--><!--]--> 服务网格产品与生态 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/servicemesh/design.html" class="sidebar-item" aria-label="服务网格的设计"><!--[--><!--]--> 服务网格的设计 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item">服务治理 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/cloudnative/service/dependency.html" class="sidebar-item" aria-label="服务依赖管理"><!--[--><!--]--> 服务依赖管理 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/service/stack.html" class="sidebar-item" aria-label="服务整栈编排"><!--[--><!--]--> 服务整栈编排 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/service/discovery.html" class="sidebar-item" aria-label="服务注册与发现"><!--[--><!--]--> 服务注册与发现 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/service/lifecycle.html" class="sidebar-item" aria-label="服务生命周期管理"><!--[--><!--]--> 服务生命周期管理 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item">流量治理 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/cloudnative/service/traffic/loadbalancing.html" class="sidebar-item" aria-label="负载均衡"><!--[--><!--]--> 负载均衡 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/service/traffic/routing.html" class="sidebar-item" aria-label="流量路由"><!--[--><!--]--> 流量路由 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/service/traffic/rate-limiting.html" class="sidebar-item" aria-label="限流设计"><!--[--><!--]--> 限流设计 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/service/traffic/mirroring.html" class="sidebar-item" aria-label="流量镜像"><!--[--><!--]--> 流量镜像 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item">可观测性 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/cloudnative/observability/definition.html" class="sidebar-item" aria-label="什么是可观测性"><!--[--><!--]--> 什么是可观测性 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/observability/metrics.html" class="sidebar-item" aria-label="指标"><!--[--><!--]--> 指标 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/observability/logging.html" class="sidebar-item" aria-label="日志"><!--[--><!--]--> 日志 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/observability/trace.html" class="sidebar-item" aria-label="链路追踪"><!--[--><!--]--> 链路追踪 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/observability/monitoring.html" class="sidebar-item" aria-label="全栈监控系统架构"><!--[--><!--]--> 全栈监控系统架构 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item">DevOps <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/cloudnative/devops/devops.html" class="sidebar-item" aria-label="打造企业 DevOps 文化"><!--[--><!--]--> 打造企业 DevOps 文化 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/devops/gitflow.html" class="sidebar-item" aria-label="软件开发工作流"><!--[--><!--]--> 软件开发工作流 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/cloudnative/devops/cicd.html" class="sidebar-item" aria-label="CI/CD 最佳实践"><!--[--><!--]--> CI/CD 最佳实践 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">何以为架构师 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloudnativenotes/end/responsibility.html" class="sidebar-item" aria-label="架构师的职责"><!--[--><!--]--> 架构师的职责 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/end/perspective.html" class="sidebar-item" aria-label="架构师的视角"><!--[--><!--]--> 架构师的视角 <!--[--><!--]--></a><!----></li><li><a href="/cloudnativenotes/end/learn.html" class="sidebar-item" aria-label="架构师的学习"><!--[--><!--]--> 架构师的学习 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/cloudnativenotes/end/dots.md" class="sidebar-item sidebar-heading" aria-label="后记：那些平淡的一天"><!--[--><!--]--> 后记：那些平淡的一天 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="容器基础技术-cgroups" tabindex="-1"><a class="header-anchor" href="#容器基础技术-cgroups" aria-hidden="true">#</a> 容器基础技术：cgroups</h1><blockquote><p>本篇基于 cgroupv2 进行介绍，对 cgroupv1 的设计不做赘述，感兴趣的同学可以参考如下文章：</p></blockquote><ul><li><a href="https://docs.kernel.org/admin-guide/cgroup-v1/index.html#cgroup-v1" target="_blank" rel="noopener noreferrer">Control Groups version 1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://coolshell.cn/articles/17049.html" target="_blank" rel="noopener noreferrer">Docker基础技术：Linux CGroup<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>cgroup（控制组，Control Group）是 Linux 内核提供的一种机制，可以限制进程/线程使用的资源，比如 CPU、内存、磁盘 IO 等。</p><h2 id="案例-cgroup-限制内存" tabindex="-1"><a class="header-anchor" href="#案例-cgroup-限制内存" aria-hidden="true">#</a> 案例：cgroup 限制内存</h2><p>我们先来看一个用 cgroup 限制进程内存使用的例子。我们使用如下代码，每秒分配 500KB 内存，然后我们使用 cgroup 将目标进程的内存使用限制为 5MB，这样程序分配的内存超过 5MB 时会被杀死。</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">cgroup</span><span class="token expression"><span class="token operator">-</span>mem<span class="token operator">-</span>test<span class="token punctuation">.</span>c</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> chunk_size <span class="token operator">=</span> <span class="token number">102400</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// 1024 bytes * 100 * 5，每次分配 500 KB</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>chunk_size<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;out of memory!!\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">memset</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> chunk_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
        size <span class="token operator">+=</span> chunk_size<span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;[%d] - memory is allocated [%8d] KB \n&quot;</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>编译后正常执行，程序会不断分配内存。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ ./cgroup-mem-test
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>     <span class="token number">500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">1000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">1500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">2000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">2500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">3000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">3500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">4000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">4500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">5000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">5500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">6000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">6500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">7000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">7500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">116459</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">8000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面我们创建 cgroup 将内存限制为 5MB。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 创建新的控制组</span>
$ <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /sys/fs/cgroup/mygroup
<span class="token comment"># 限制最大内存为 5MB，这里是用的字节</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token variable">))</span></span> <span class="token operator">&gt;</span> /sys/fs/cgroup/mygroup/memory.max

<span class="token comment"># 启动程序后，将进程 ID 加入到控制组</span>
./cgroup-mem-test <span class="token operator">&amp;</span> <span class="token builtin class-name">echo</span> <span class="token variable">$!</span> <span class="token operator">&gt;</span> /sys/fs/cgroup/mygroup/cgroup.procs

$ <span class="token function">sudo</span> <span class="token function">cat</span> /sys/fs/cgroup/mygroup/cgroup.procs
<span class="token number">118058</span>

$ ./cgroup-mem-test
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>     <span class="token number">500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">1000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">1500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">2000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">2500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">3000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">3500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">4000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">4500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">5000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">5500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">6000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">6500</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">118058</span><span class="token punctuation">]</span> - memory is allocated <span class="token punctuation">[</span>    <span class="token number">7000</span><span class="token punctuation">]</span> KB
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token number">118058</span> killed     ./cgroup-mem-test
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到程序在运行一段时间后被 kill 掉了，使用 <code>journalctl -k</code> 命令查看日志可以看到如下信息：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Mar <span class="token number">17</span> <span class="token number">15</span>:43:44 vm-01 kernel: Tasks state <span class="token punctuation">(</span>memory values <span class="token keyword">in</span> pages<span class="token punctuation">)</span>:
Mar <span class="token number">17</span> <span class="token number">15</span>:43:44 vm-01 kernel: <span class="token punctuation">[</span>  pid  <span class="token punctuation">]</span>   uid  tgid total_vm      rss pgtables_bytes swapents oom_score_adj name
Mar <span class="token number">17</span> <span class="token number">15</span>:43:44 vm-01 kernel: <span class="token punctuation">[</span> <span class="token number">118058</span><span class="token punctuation">]</span>  <span class="token number">1000</span> <span class="token number">118058</span>     <span class="token number">2584</span>     <span class="token number">2196</span>    <span class="token number">61440</span>        <span class="token number">0</span>             <span class="token number">0</span> cgroup-mem-test
Mar <span class="token number">17</span> <span class="token number">15</span>:43:44 vm-01 kernel: oom-kill:constraint<span class="token operator">=</span>CONSTRAINT_MEMCG,nodemask<span class="token operator">=</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span>,cpuset<span class="token operator">=</span>mygroup,mems_allowed<span class="token operator">=</span><span class="token number">0</span>,oom_memcg<span class="token operator">=</span>/mygroup,task_memcg<span class="token operator">=</span>/mygroup,task<span class="token operator">=</span>cgroup-mem-test,pid<span class="token operator">=</span><span class="token number">118058</span>,uid<span class="token operator">=</span><span class="token number">1000</span>
Mar <span class="token number">17</span> <span class="token number">15</span>:43:44 vm-01 kernel: Memory cgroup out of memory: Killed process <span class="token number">118058</span> <span class="token punctuation">(</span>cgroup-mem-test<span class="token punctuation">)</span> total-vm:10336kB, anon-rss:7160kB, file-rss:1624kB, shmem-rss:0kB, <span class="token environment constant">UID</span>:1000 pgtables:60kB oom_score_adj:0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从日志看出起实际内存为 2196 页，即 2196 * 4KB 大约 8MB，超出了 cgroup 的限制，因此在 cgroup 范围内（constraint=CONSTRAINT_MEMCG）由 mygroup (task_memcg=/mygroup) 控制组杀死，最终报 <code>Memory cgroup out of memory: Killed process 118058 (cgroup-mem-test) </code> 错误。</p><p>通过以上例子我们可以对 cgroup 有一个直观的认识，下面我们来系统梳理下 cgroup 的相关概念和用法。</p><h2 id="cgroup-术语" tabindex="-1"><a class="header-anchor" href="#cgroup-术语" aria-hidden="true">#</a> cGroup 术语</h2><h3 id="控制器-controller" tabindex="-1"><a class="header-anchor" href="#控制器-controller" aria-hidden="true">#</a> 控制器（controller）</h3><p><img src="https://pub-08b57ed9c8ce4fadab4077a9d577e857.r2.dev/cgroup-v2-01.png" alt=""> 图片来自：<a href="https://facebookmicrosites.github.io/cgroup2/docs/overview.html" target="_blank" rel="noopener noreferrer">cgroup2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>控制器也叫做子系统，是 Linux 提供的管理各种资源限制的对象，比如我们例子用到的 memory.max 就属于 memory 子系统。下面是 cgroup v2 支持的一些控制器：</p><table><thead><tr><th>子系统</th><th>主要功能</th><th>关键接口文件</th></tr></thead><tbody><tr><td>cpu</td><td>控制CPU使用和调度</td><td>cpu.max, cpu.weight, cpu.stat</td></tr><tr><td>cpuset</td><td>控制CPU核心和内存节点分配</td><td>cpuset.cpus, cpuset.mems</td></tr><tr><td>memory</td><td>控制内存使用</td><td>memory.max, memory.high, memory.low, memory.current</td></tr><tr><td>io</td><td>控制块设备I/O</td><td>io.max, io.weight, io.stat</td></tr><tr><td>pids</td><td>控制进程数量</td><td>pids.max, pids.current</td></tr><tr><td>freezer</td><td>控制组暂停/恢复</td><td>cgroup.freeze</td></tr><tr><td>hugetlb</td><td>控制大页内存</td><td>hugetlb.*</td></tr><tr><td>rdma</td><td>控制远程直接内存访问</td><td>rdma.*</td></tr><tr><td>perf_event</td><td>控制性能监控</td><td>perf_event.*</td></tr><tr><td>devices</td><td>控制设备访问</td><td>devices.*</td></tr><tr><td>net_cls/net_prio</td><td>控制网络数据包分类和优先级</td><td>net_cls., net_prio.</td></tr></tbody></table><p>上述各个控制器有若干关键接口文件，用来实现相应的资源限制，比如我们上面的例子使用 <code>memory.max</code> 限制进程最大内存使用。下面是全部控制器的关键接口文件：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ubuntu @ vm-01 in /sys/fs/cgroup/mygroup [15:56:35]</span>
$ ll
total <span class="token number">0</span>
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cgroup.controllers
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cgroup.events
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cgroup.freeze
--w------- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cgroup.kill
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cgroup.max.depth
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cgroup.max.descendants
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:43 cgroup.procs
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cgroup.stat
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cgroup.subtree_control
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cgroup.threads
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cgroup.type
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpu.idle
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpu.max
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpu.max.burst
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpu.pressure
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpuset.cpus
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpuset.cpus.effective
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpuset.cpus.partition
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpuset.mems
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpuset.mems.effective
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpu.stat
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpu.uclamp.max
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpu.uclamp.min
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpu.weight
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 cpu.weight.nice
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 io.max
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 io.pressure
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 io.prio.class
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 io.stat
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 io.weight
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:28 memory.current
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.events
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.events.local
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.high
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.low
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:35 memory.max
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.min
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.numa_stat
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.oom.group
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.pressure
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.stat
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.swap.current
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.swap.events
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.swap.high
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 memory.swap.max
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 pids.current
-r--r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 pids.events
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> Mar <span class="token number">17</span> <span class="token number">15</span>:56 pids.max

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过 cgroup 丰富的控制器，我们可以实现如下功能：</p><ul><li>资源限制，比如限制内存的使用、文件系统缓存的大小等。</li><li>优先级控制，通过对 cpu、io 等资源的分配，可以控制不同进程的优先级。</li><li>审计，可以统计进程的资源使用情况，比如 cpu 使用时间、内存使用情况等。</li><li>进程管理，比如可以通过 freeze 接口文件来控制组内进程的挂起与恢复。</li></ul><h3 id="控制组-control-group" tabindex="-1"><a class="header-anchor" href="#控制组-control-group" aria-hidden="true">#</a> 控制组（control group）</h3><p>控制组（control group）就是针对一组资源做限制的组合了。通常一个控制组内可以根据需求设置不同的控制器，然后将进程或者线程加入到控制组中，从而实现特定进程的资源进行限制。</p><h3 id="层级结构" tabindex="-1"><a class="header-anchor" href="#层级结构" aria-hidden="true">#</a> 层级结构</h3><p>控制组可以组织成一个树状的层级结构，从而实现更精细的资源限制。</p><p>cgroup v2 对层级结构进行了精简，最开始通常只有根控制组，位于 <code>/sys/fs/cgroup</code> 目录下，我们可以通过创建新目录的方式创建新的控制组，比如我们上面的例子创建 <code>/sys/fs/cgroup/mygroup</code> 目录，就是创建了一个新的控制组。</p><p>子系统控制组可以从父控制组继承资源限制并可以继续细化，但只能做进一步的资源限制，而不能放宽限制。控制组通过两个文件来控制自身以及子控制组所能设置的资源限制：</p><ul><li><code>cgroup.controllers</code>：控制组可以使用的控制器。</li><li><code>cgroup.subtree_control</code>：子控制组可以继承的控制器。</li></ul><p>可以通过 +，- 符号来表示在控制组中启用或禁用某个控制器，比如下面的例子，在 <code>cg1</code> 控制组中禁用 <code>memory</code> 控制器，启用 <code>cpu</code> 控制器。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&#39;+cpu -memory&#39;</span> <span class="token operator">&gt;</span> /sys/fs/cgroup/cg1/cgroup.subtree_control
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>下图是官网提供的图例，通过上述两个文件，对不同的服务进行精细的资源限制。</p><p><img src="https://pub-08b57ed9c8ce4fadab4077a9d577e857.r2.dev/cgroup-v2-02.png" alt=""> 图片来自：<a href="https://facebookmicrosites.github.io/cgroup2/docs/overview.html" target="_blank" rel="noopener noreferrer">cgroup2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="任务-task" tabindex="-1"><a class="header-anchor" href="#任务-task" aria-hidden="true">#</a> 任务（task）</h3><p>任务（task）就是进程或者线程，可以加入到控制组中。在 cgroup v2 中，任务加入到控制组的方式有两种：</p><ol><li>通过 <code>cgroup.procs</code> 文件将进程 ID 写入到控制组中，从而将进程加入到控制组中。</li><li>通过 <code>cgroup.threads</code> 文件将线程 ID 写入到控制组中，从而将线程加入到控制组中。</li></ol><p>下面是使用 <code>cgroup.procs</code> 将进程加入到控制组中的例子：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 将进程 ID 写入到控制组中</span>
<span class="token builtin class-name">echo</span> <span class="token number">118058</span> <span class="token operator">&gt;</span> /sys/fs/cgroup/mygroup/cgroup.procs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>一个进程只能处于一个控制组中。</p><h3 id="文件系统" tabindex="-1"><a class="header-anchor" href="#文件系统" aria-hidden="true">#</a> 文件系统</h3><p>cgroup 是</p></div><!--[--><!--[--><div class="page-info" data-v-efed79f6><div class="star" data-v-efed79f6><span data-v-efed79f6><a data-icon="octicon-star" href="https://github.com/zouyingjie/cloudnative-notes">Star 关注</a></span></div><div class="last-updated" data-v-efed79f6><span class="prefix" data-v-efed79f6>总字数:</span><span class="words" data-v-efed79f6>2305</span><span class="prefix" data-v-efed79f6>字</span></div></div><div id="comment" class="giscus-wrapper input-top layout-comment" style="display:block;" data-v-efed79f6><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--]--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/zouyingjie/cloudnativenotes/edit/main/cloudnative/container/docker-cgroups.md" rel="noopener noreferrer" target="_blank" aria-label="在GitHub中编辑"><!--[--><!--]--> 在GitHub中编辑 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: yingjiezou1@gmail.com">zouyingjie</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/cloudnativenotes/cloudnative/container/docker-namespace.html" class="" aria-label="容器基础技术：namespace"><!--[--><!--]--> 容器基础技术：namespace <!--[--><!--]--></a></span><span class="next"><a href="/cloudnativenotes/cloudnative/container/docker-filesystem.html" class="" aria-label="容器基础技术：文件系统"><!--[--><!--]--> 容器基础技术：文件系统 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/cloudnativenotes/assets/app-C-eiXR-Q.js" defer></script>
  </body>
</html>
